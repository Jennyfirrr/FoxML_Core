# System-Level Configuration
# Settings for system paths, environment, and shell configuration

system:
  # Paths
  paths:
    data_dir: "data/data_labeled_v2/interval=5m"  # Default data directory (SST: single source)
    output_dir: null  # null = auto-generated, or set custom path
    temp_dir: null  # null = use system temp, or set custom path
    joblib_temp: null  # null = ~/trainer_tmp/joblib, or set custom path
    model_cache_dir: null  # null = no caching, or set directory for model caching
    
    # Config file paths (relative to repo root, or absolute paths)
    config_dir: "CONFIG"  # Main config directory
    excluded_features: null  # null = CONFIG/excluded_features.yaml, or set custom path
    feature_registry: "data/feature_registry.yaml"  # Canonical registry: CONFIG/data/feature_registry.yaml (SST)
    feature_target_schema: null  # null = CONFIG/feature_target_schema.yaml, or set custom path
    config_backup_dir: null  # null = CONFIG/backups/, or set custom backup directory
  
  # Backup System Settings
  backup:
    max_backups_per_target: 20  # Maximum number of backups to keep per target (0 = no limit)
    enable_retention: true  # Enable automatic pruning of old backups
  
  # Environment Variables
  environment:
    # Shell Settings (for subprocess suppression)
    shell: "/usr/bin/bash"
    term: "dumb"
    inputrc: "/dev/null"
    
    # Python Settings
    pythonpath: null  # null = auto-set to project root, or set custom
    pythonhashseed: "42"
    
    # Joblib Settings
    joblib_start_method: "spawn"  # Process start method for joblib
    joblib_temp_folder: null  # null = use paths.joblib_temp, or set custom
    
    # Training Control
    trainer_tmp: null  # Override temp directory
    training_tmpdir: null  # Alternative temp directory override
  
  # Logging
  logging:
    level: "INFO"  # Logging level: "DEBUG", "INFO", "WARNING", "ERROR"
    format: null  # null = default format, or set custom format
    file: null  # null = console only, or set log file path
    
    # Component-specific log levels
    component_levels:
      tensorflow: "WARNING"  # TensorFlow log level
      xgboost: "WARNING"  # XGBoost log level
      lightgbm: "WARNING"  # LightGBM log level
  
  # Isolation Runner Settings
  isolation:
    timeout_seconds: 7200  # 2 hours default timeout
    memory_cap_gb: 0  # 0 = disabled, or set GB limit
    disable_memory_cap: false  # Set to true to disable memory cap check
    force_isolation_for: []  # List of families to force isolation
    no_isolation_for: []  # List of families to prevent isolation
    memory_check_interval_seconds: 2  # Interval between memory checks in isolated processes
  
  # Security & Safety
  security:
    # Readline suppression (for subprocess error suppression)
    suppress_readline_errors: true
    suppress_tensorflow_warnings: false  # Keep TensorFlow warnings visible for diagnostics
    
    # MKL Guard (for families prone to segfaults)
    mkl_guard_enabled: true
    risky_mkl_families:  # Families that need MKL guard
      - "ChangePoint"
      - "GMMRegime"
  
  # Subprocess Settings
  subprocess:
    default_timeout_seconds: 2  # Default timeout for subprocess commands (e.g., nvidia-smi)
    safe_env_vars: true  # Use safe environment variables (TERM=dumb, etc.)
  
  # Performance
  performance:
    # Polars Settings
    use_polars: true  # Use Polars for data processing
    polars_max_threads: null  # null = use DEFAULT_THREADS
    
    # Cross-Sectional Alignment
    cs_align_mode: "union"  # "union" or "intersection"
    
    # Sequential Dataset
    sequential_batch_size: 32  # Default batch size for sequential dataloaders
    sequential_num_workers: 0  # 0 for deterministic behavior
    sequential_pin_memory: true
    sequential_prefetch_factor: 2

